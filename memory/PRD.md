# Voice Workspace — PRD

## Original Problem Statement
Приложение для транскрибации аудио/видео встреч с AI-обработкой и разметкой спикеров.

## Core Requirements
1. Автоматическая транскрибация (Deepgram)
2. AI-анализ встреч (резюме, задачи, риски) через OpenAI GPT
3. Разметка спикеров: кликабельные теги в транскрипте, редактирование имён
4. Справочник спикеров с поддержкой формата "Имя Фамилия (Компания)"
5. Управление спикерами — только на вкладке "Транскрипт"
6. **Конструктор сценариев анализа** — визуальный редактор пайплайнов на React Flow

## Architecture
- **Backend:** FastAPI + MongoDB (motor) + Pydantic
- **Frontend:** React + Tailwind + Shadcn/UI + React Flow (@xyflow/react)
- **AI:** OpenAI GPT через Emergent LLM Key
- **Transcription:** Deepgram

## What's Been Implemented
- [x] Транскрибация и обработка аудио/видео
- [x] Разметка и редактирование спикеров
- [x] Справочник спикеров с парсингом "Имя (Компания)"
- [x] AI-обработка с подстановкой полных имён спикеров
- [x] Мастер-анализ (визард): извлечение тем → батч-анализ → резюме
- [x] Библиотека промптов
- [x] **Сценарии анализа — бэкенд CRUD API** (Dec 2025)
- [x] **Визуальный конструктор пайплайнов на React Flow** (Dec 2025)
  - 7 типов узлов: ai_prompt, parse_list, batch_loop, aggregate, template, user_edit_list, user_review
  - Дефолтный пайплайн "Стандартный анализ встречи" (9 узлов)
  - Панель настроек узла с полями по типу
  - CRUD + дублирование пайплайнов
  - Навигация из дашборда

## Prioritized Backlog
### P0 — Следующие шаги
- [ ] Рефакторинг FullAnalysisTab — выполнение анализа по выбранному пайплайну вместо хардкода
- [ ] Выбор сценария анализа при запуске мастер-анализа в проекте

### P1
- [ ] Возможность выбирать промпт из библиотеки в конструкторе (prompt_id)
- [ ] Создание нового промпта прямо из конструктора (автосохранение в библиотеку)

### P2 — Будущие механики
- [ ] condition (ветвление по содержимому ответа AI)
- [ ] extract_json (парсинг структурированного JSON)
- [ ] merge (объединение параллельных веток)
